# VPS Backend

A modern Rust backend server built with Axum, providing a RESTful API with standardized JSON responses, CORS support, and environment-based configuration.

## Features

- ğŸš€ Built with Axum framework
- ğŸ”„ Standardized API responses
- ğŸ”’ CORS configuration for development
- ğŸ”‘ API key authentication middleware
- ğŸ“ Static file serving
- ğŸ“ Request logging with tracing
- âš™ï¸ Environment-based configuration
- ğŸ—„ï¸ SQLite database integration
- âœ¨ Clean and modular architecture

## Setup

1. Clone the repository
2. Copy `.env.example` to `.env` and adjust the values if needed:
   ```bash
   cp .env.example .env
   ```
3. Build and run the server:
   ```bash
   cargo run
   ```

## Configuration

The server can be configured through environment variables in the `.env` file:

```env
# Server configuration
HOST=127.0.0.1
PORT=8000

# Security configuration
API_KEY=your-secret-api-key-here

# Logging configuration
RUST_LOG=info  # Available levels: error, warn, info, debug, trace

# CORS configuration
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
```

**Required variables:**
- `API_KEY` - Secret key for API authentication (must be set)

## API Endpoints

### Public Endpoints

#### Health Check
- **GET /** - Returns a simple greeting message
  ```json
  {
    "status": 200,
    "success": true,
    "data": {
      "message": "Hello, I'm Tom Planche!"
    }
  }
  ```

#### Static Files
- **GET /static/** - Serves static files from the `static` directory
  
  For now, it serves files generated by my [LastFM Fetcher](https://github.com/TomPlanche/vps-lastfm).

### Protected Endpoints

Protected endpoints require an API key to be provided in the `x-api-key` header.

#### Get Sources
- **GET /source** - Retrieves all tracked sources and their counts
  
  **Headers:**
  ```
  x-api-key: your-api-key-here
  ```
  
  **Response:**
  ```json
  {
    "status": 200,
    "success": true,
    "data": {
      "github": 42,
      "linkedin": 15,
      "twitter": 8
    }
  }
  ```

#### Increment Source
- **POST /source** - Increments the counter for a specific source
  
  **Headers:**
  ```
  x-api-key: your-api-key-here
  Content-Type: application/json
  ```
  
  **Request Body:**
  ```json
  {
    "source": "github"
  }
  ```
  
  **Response:**
  ```json
  {
    "status": 200,
    "success": true,
    "data": {
      "source": "github",
      "count": 43
    }
  }
  ```

#### Authentication Errors
If an invalid or missing API key is provided:
```json
{
  "status": 401,
  "success": false,
  "error": {
    "message": "Invalid API key"
  }
}
```

## Development

The server includes request logging through the `tracing` crate. You can adjust the log level by modifying the `RUST_LOG` environment variable in your `.env` file.

## License

This project is licensed under the MIT License - see the LICENSE file for details.